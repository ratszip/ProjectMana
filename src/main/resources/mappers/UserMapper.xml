<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.thf.dao.UserDAO">
    <insert id="insertUser" useGeneratedKeys="true" keyProperty="userId">
        insert into users(
        <if test="phone != null and phone != ''">
            phone,
        </if>
        <if test="email != null and email != ''">
            email,
        </if>
        password,register_time) values(
        <if test="phone != null and phone != ''">
            #{phone},
        </if>
        <if test="email != null and email != ''">
            #{email},
        </if>
        #{password},#{registerTime})
    </insert>

        <resultMap type="User" id="userMap">
            <id column="user_id" property="userId"/>
            <result column="user_type" property="userType"/>
            <result column="username" property="username"/>
            <result column="password" property="password"/>
            <result column="user_introduce" property="userIntroduce"/>
            <result column="register_time" property="registerTime"/>
            <result column="phone" property="phone"/>
            <result column="email" property="email"/>
            <result column="user_address" property="userAddress"/>
            <result column="user_img" property="userImg"/>
        </resultMap>

    <select id="searchEmail" resultMap="userMap">
        select
        *
        from users
        where
        email = #{email}
        <!--        <where>-->
        <!--        <if test="email != null and email!=''">-->
        <!--            email=#{email}-->
        <!--        </if>-->
        <!--        <if test="phone != null and phone!=''">-->
        <!--           and phone=#{phone}-->
        <!--        </if>-->
        <!--        </where>-->
    </select>
    <select id="searchPhone" resultMap="userMap">
        select
        *
        from users
        where
        phone = #{phone}
    </select>

    <update id="updateUsers">
        update users
        set
        username = #{username},
        user_introduce = #{userIntroduce},
        user_address = #{userAddress}
        where
        user_id = #{userId}
    </update>

    <select id="searchById" resultMap="userMap">
        select
        *
        from users
        where
        user_id = #{userId}
    </select>
</mapper>